# 一、功能介绍

## 简介

在开发过程中，RM代码需要添加RM打印点打印关键节点的数据内容与RTL进行比对，该脚本通过解析源文件中特定格式的注释，生成RM打印代码和开关文件进行关键节点的数据打印。

相比较于以往的RM打印脚本，本脚本主要从可移植性、简洁性、扩展性三个角度进行优化。

- 可移植性：打印点的添加采用注释的形式，不依赖特定工程。用户只需要修改脚本中的一小部分即可完成适配。
- 简洁性：脚本仅在源文件中插入一行宏定义即完成打印点的添加
- 扩展性：来源于两个方面：第一、脚本将注释格式的打印点解析为字典，用户可随意添加额外参数对打印方式进行扩展。第二、打印节点的宏其本质为调用工程中的自有函数和自有变量，可充分利用源工程的资源。

脚本实现过程如下：

1. 用户在代码中添加RM打印相关注释语句
2. 脚本自动查找注释语句并解析为字典
3. 脚本依据字典内容生成RM开关文件和Define宏文件
4. 脚本自动将打印宏添加至源代码

## 简要例子

1. RM打印注释举例

![RM打印注释截图](D:\program\Python\RmDumpAutoAdd\pic\RM打印注释截图.bmp)

2. 解析出的字典举例

![解析出的字典内容](D:\program\Python\RmDumpAutoAdd\pic\解析出的字典内容.bmp)

3. 脚本本生成的宏定义文件和RM开关文件举例

![生成的文件](D:\program\Python\RmDumpAutoAdd\pic\生成的文件.bmp)

4. 宏定义插入源文件

![插入源文件代码](D:\program\Python\RmDumpAutoAdd\pic\插入源文件代码.bmp)

5. RM打印宏插入前后代码对比

![RM打印点插入前后对比](.\pic\RM打印点插入前后对比.bmp)

# 二、背景

在开发过程中，RM代码需要添加RM打印点打印关键节点的数据内容与RTL进行比。在以往的脚本中通常是这么做的，



Excel维护麻烦

脚本的作用仅仅是生成文件指针和文件开关

打印格式需求的增多导致重构函数太多：定浮点选择，定点格式配置，进制选择，帧号指示，维度打印配置，使能开关配置，缩放配置等。需要将重构函数合并为配置结构体，但会令源代码添加过多RM打印语句

# 三、实现思路

# 四、详细介绍

# 五、代码讲解







